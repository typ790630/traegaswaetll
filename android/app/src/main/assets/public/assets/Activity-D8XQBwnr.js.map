{"version":3,"file":"Activity-D8XQBwnr.js","sources":["../../node_modules/lucide-react/dist/esm/icons/external-link.js","../../node_modules/lucide-react/dist/esm/icons/refresh-cw.js","../../src/services/ActivityService.ts","../../src/pages/Activity.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.511.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M15 3h6v6\", key: \"1q9fwt\" }],\n  [\"path\", { d: \"M10 14 21 3\", key: \"gplh6r\" }],\n  [\"path\", { d: \"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\", key: \"a6xqqp\" }]\n];\nconst ExternalLink = createLucideIcon(\"external-link\", __iconNode);\n\nexport { __iconNode, ExternalLink as default };\n//# sourceMappingURL=external-link.js.map\n","/**\n * @license lucide-react v0.511.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\", key: \"v9h5vc\" }],\n  [\"path\", { d: \"M21 3v5h-5\", key: \"1q7to0\" }],\n  [\"path\", { d: \"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\", key: \"3uifl3\" }],\n  [\"path\", { d: \"M8 16H3v5\", key: \"1cv678\" }]\n];\nconst RefreshCw = createLucideIcon(\"refresh-cw\", __iconNode);\n\nexport { __iconNode, RefreshCw as default };\n//# sourceMappingURL=refresh-cw.js.map\n","import { ChainService } from './ChainService'\nimport { ActivityItem } from '../types'\n\n// Simulation of an Indexer Service (like The Graph or Etherscan API)\n// This service manages blockchain activity history.\n\n// In-memory mock database for simulation\n// In a real app, this would be queried from an API endpoint\nconst DB: {\n  activities: Record<string, ActivityItem[]> // userAddress -> activities\n} = {\n  activities: {}\n}\n\nconst delay = (ms: number) => new Promise(resolve => setTimeout(resolve, ms))\n\nexport const ActivityService = {\n  // Initialize user activity list if empty\n  initUser: (address: string) => {\n    if (!DB.activities[address]) {\n      DB.activities[address] = []\n    }\n    return DB.activities[address]\n  },\n\n  // Fetch activities (Simulate API GET)\n  getActivities: async (address: string): Promise<ActivityItem[]> => {\n    // 1. Fetch real activities from chain (RADRS + USDT + ...)\n    const realActivities = await ChainService.getAllActivity(address)\n    \n    // 2. Fetch mock activities\n    ActivityService.initUser(address)\n    const mockActivities = DB.activities[address]\n\n    // 3. Merge: Prefer real activities over mock if hash matches (deduplication)\n    const all = [...realActivities, ...mockActivities]\n    \n    // Remove duplicates by hash if any\n    const unique = Array.from(new Map(all.map(item => [item.hash, item])).values())\n    \n    return unique.sort((a, b) => b.timestamp - a.timestamp)\n  },\n\n  // Add new activity (Simulate Indexer catching a new event)\n  addActivity: async (address: string, activity: Omit<ActivityItem, 'id' | 'timestamp'>): Promise<ActivityItem> => {\n    await delay(300)\n    ActivityService.initUser(address)\n    \n    const newActivity: ActivityItem = {\n      ...activity,\n      id: `tx_${Math.random().toString(36).substr(2, 9)}`,\n      timestamp: Date.now(),\n      // Ensure date is present, if not provided in omit (though type says it is, let's just handle it safely)\n    }\n\n    DB.activities[address].unshift(newActivity)\n    return newActivity\n  },\n\n  // Clear activities (for testing)\n  clearActivities: (address: string) => {\n    DB.activities[address] = []\n  }\n}\n","import { useState, useEffect } from \"react\"\r\nimport { ArrowUpRight, ArrowDownLeft, ArrowRightLeft, FileText, ExternalLink, RefreshCw } from \"lucide-react\"\r\nimport { Badge } from \"../components/ui/badge\"\r\nimport { cn } from \"../lib/utils\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { useAppStore } from \"../store/useAppStore\"\r\nimport { ActivityService } from \"../services/ActivityService\"\r\nimport { ActivityItem } from \"../types\"\r\n\r\n\r\ntype Filter = \"All\" | \"Wallet\" | \"Swap\"\r\n\r\nexport default function Activity() {\r\n  const { t } = useTranslation()\r\n  const { getCurrentWallet, activities, setActivities } = useAppStore()\r\n  const wallet = getCurrentWallet()\r\n  \r\n  const [filter, setFilter] = useState<Filter>(\"All\")\r\n  // Remove local activities state, use store\r\n  const [isLoading, setIsLoading] = useState(false)\r\n\r\n  const loadActivities = async () => {\r\n    if (!wallet) return\r\n    setIsLoading(true)\r\n    try {\r\n      const data = await ActivityService.getActivities(wallet.address)\r\n      if (Array.isArray(data)) {\r\n        // Merge with existing activities to prevent clearing local pending ones?\r\n        // Actually ActivityService.getActivities already tries to merge.\r\n        // For now, let's trust the service or just overwrite since we want chain data.\r\n        // But to keep it \"instant\", we just update the store.\r\n        setActivities(data)\r\n      } else {\r\n        console.error(\"Activity data is not an array:\", data)\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Failed to load activities\", error)\r\n    } finally {\r\n      setIsLoading(false)\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (wallet?.address) {\r\n      loadActivities()\r\n      \r\n      const interval = setInterval(() => {\r\n        loadActivities()\r\n      }, 30000)\r\n\r\n      return () => clearInterval(interval)\r\n    }\r\n  }, [wallet?.address])\r\n\r\n  const openExplorer = (hash: string) => {\r\n      if (!hash) return\r\n      // Default to BSC Scan for now\r\n      window.open(`https://bscscan.com/tx/${hash}`, '_blank')\r\n  }\r\n\r\n  if (!wallet) {\r\n      return <div className=\"p-8 text-center text-text-secondary\">Wallet not connected</div>\r\n  }\r\n\r\n  const filteredActivities = activities.filter(a => {\r\n    if (filter === \"All\") return true\r\n    if (filter === \"Wallet\") return a.type === \"Send\" || a.type === \"Receive\"\r\n    if (filter === \"Swap\") return a.type === \"Swap\"\r\n    return true\r\n  })\r\n\r\n  const getIcon = (type: string) => {\r\n    switch (type) {\r\n      case \"Send\": return <ArrowUpRight className=\"w-5 h-5 text-text-primary\" />\r\n      case \"Receive\": return <ArrowDownLeft className=\"w-5 h-5 text-accent\" />\r\n      case \"Swap\": return <ArrowRightLeft className=\"w-5 h-5 text-status-info\" />\r\n      default: return <FileText className=\"w-5 h-5 text-text-secondary\" />\r\n    }\r\n  }\r\n\r\n  const getTranslatedType = (type: string) => {\r\n    switch (type) {\r\n      case \"Send\": return t('wallet.send')\r\n      case \"Receive\": return t('wallet.receive')\r\n      case \"Swap\": return t('wallet.swap')\r\n      default: return type\r\n    }\r\n  }\r\n\r\n  const formatTime = (timestamp: number) => {\r\n      // Mock \"Today/Yesterday\" logic or just simple date\r\n      const date = new Date(timestamp)\r\n      return date.toLocaleString()\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-4 pt-8 pb-24 max-w-md mx-auto\">\r\n      <div className=\"flex items-center justify-between mb-6\">\r\n          <h1 className=\"text-2xl font-bold\">{t('activity.title')}</h1>\r\n          <button onClick={loadActivities} className={`p-2 rounded-full hover:bg-white/5 transition-all ${isLoading ? 'animate-spin' : ''}`}>\r\n              <RefreshCw className=\"w-5 h-5 text-text-secondary\" />\r\n          </button>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <div className=\"flex gap-2 mb-6 overflow-x-auto pb-2 scrollbar-hide\">\r\n        {([\"All\", \"Wallet\", \"Swap\"] as Filter[]).map((f) => (\r\n          <button\r\n            key={f}\r\n            onClick={() => setFilter(f)}\r\n            className={cn(\r\n              \"px-4 py-2 rounded-full text-sm font-medium transition-colors whitespace-nowrap\",\r\n              filter === f \r\n                ? \"bg-accent text-background-primary\" \r\n                : \"bg-card text-text-secondary hover:text-text-primary\"\r\n            )}\r\n          >\r\n            {f === 'All' ? t('activity.all') : f === 'Wallet' ? t('activity.wallet') : t('wallet.swap')}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* List */}\r\n      <div className=\"space-y-3\">\r\n        {filteredActivities.length === 0 && !isLoading && (\r\n          <div className=\"text-center py-12 text-text-secondary\">\r\n            {t('activity.noActivity')}\r\n          </div>\r\n        )}\r\n        \r\n        {isLoading && filteredActivities.length === 0 && (\r\n             <div className=\"text-center py-12 text-text-secondary animate-pulse\">\r\n                {t('common.loading', 'Loading...')}\r\n            </div>\r\n        )}\r\n\r\n        {filteredActivities.map((activity) => (\r\n          <div \r\n            key={activity.id}\r\n            onClick={() => openExplorer(activity.hash)}\r\n            className=\"flex items-center justify-between p-4 rounded-xl bg-card border border-divider/50 hover:border-accent/30 transition-colors group cursor-pointer\"\r\n          >\r\n            <div className=\"flex items-center gap-4\">\r\n              <div className={cn(\r\n                \"flex items-center justify-center w-10 h-10 rounded-full bg-background-secondary border border-divider\",\r\n                activity.type === \"Receive\" && \"bg-accent/10 border-accent/20\"\r\n              )}>\r\n                {getIcon(activity.type)}\r\n              </div>\r\n              \r\n              <div className=\"flex flex-col\">\r\n                <span className=\"font-semibold text-text-primary\">{getTranslatedType(activity.type)}</span>\r\n                <span className=\"text-xs text-text-secondary\">{activity.date}</span>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex flex-col items-end\">\r\n              <span className={cn(\r\n                \"font-medium tabular-nums\",\r\n                activity.type === 'Receive' ? \"text-status-success\" : \"text-text-primary\"\r\n              )}>\r\n                {activity.type === 'Send' ? '-' : activity.type === 'Receive' ? '+' : ''}\r\n                {activity.amount || activity.asset}\r\n              </span>\r\n              <div className=\"flex items-center gap-1.5 mt-1\">\r\n                <Badge variant={activity.status === \"Success\" ? \"success\" : activity.status === \"Pending\" ? \"warning\" : \"destructive\"} className=\"text-[10px] h-4 px-1\">\r\n                  {activity.status === \"Success\" ? t('common.success') : activity.status}\r\n                </Badge>\r\n                {activity.status !== \"Pending\" && (\r\n                    <ExternalLink className=\"w-3 h-3 text-text-secondary opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":["__iconNode","ExternalLink","createLucideIcon","RefreshCw","DB","delay","ms","resolve","ActivityService","address","realActivities","ChainService","mockActivities","all","item","a","b","activity","newActivity","Activity","t","useTranslation","getCurrentWallet","activities","setActivities","useAppStore","wallet","filter","setFilter","useState","isLoading","setIsLoading","loadActivities","data","error","useEffect","interval","openExplorer","hash","jsx","filteredActivities","getIcon","type","ArrowUpRight","ArrowDownLeft","ArrowRightLeft","FileText","getTranslatedType","jsxs","f","cn","Badge"],"mappings":"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","x_google_ignoreList":[0,1]}