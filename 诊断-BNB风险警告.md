# 🛡️ BNB 转账风险警告诊断

## 问题现象

转账 BNB 时出现警告界面：
- 标题：此交易存在风险
- 内容：检测到签名存在极高风险，为确保你的资产安全，交易将被取消。
- 底部按钮：了解 Web3 风险案例、取消

---

## 🔍 **诊断步骤**

### **步骤 1：确认警告来源**

这个警告界面**不在当前代码库中**。可能来源：

#### 1️⃣ **第三方钱包扩展（最可能）**

如果您的浏览器安装了以下扩展，它们可能会拦截交易：
- ❌ MetaMask
- ❌ TrustWallet
- ❌ TokenPocket
- ❌ imToken
- ❌ Coinbase Wallet

**解决方法：**
```bash
# 1. 打开浏览器扩展管理
chrome://extensions/（Chrome）
edge://extensions/（Edge）

# 2. 临时禁用所有钱包扩展

# 3. 刷新页面，重新测试转账
```

---

#### 2️⃣ **安全软件拦截**

某些安全软件会检测区块链交易：
- 360 安全卫士
- 腾讯电脑管家
- 火绒安全

**解决方法：**
- 临时关闭安全软件
- 或添加网站到白名单

---

#### 3️⃣ **浏览器安全警告**

部分浏览器（如 Brave）内置加密货币保护：

**解决方法：**
```bash
# Brave 浏览器
设置 → Shields → 加密货币 → 关闭

# Edge 浏览器
设置 → 隐私 → 安全 → 关闭钓鱼检测
```

---

#### 4️⃣ **自定义风险检测代码**

如果之前添加过风险检测功能，检查：
- `src/pages/Send.tsx`
- `src/services/*`
- `src/components/ui/*`

搜索关键词：
```bash
# 在项目根目录运行
grep -r "风险" src/
grep -r "risk" src/
grep -r "检测到签名" src/
```

---

### **步骤 2：检查转账目标地址**

某些地址可能被标记为高风险：

#### ❌ **黑名单地址**
- 已知诈骗地址
- 制裁地址（OFAC）
- 被盗资金接收地址

#### ⚠️ **异常地址**
- 新创建的合约地址
- 未激活的地址（余额为0）
- 混币器地址（Tornado Cash 等）

**检查方法：**
```bash
# 在 BSCScan 查询目标地址
https://bscscan.com/address/[目标地址]

# 查看：
1. 地址类型（EOA 还是 Contract）
2. 交易历史（是否正常）
3. 是否有风险标记（Phishing、Scam 等）
```

---

### **步骤 3：检查转账金额**

#### ⚠️ **大额转账**
- 单笔 > 10 BNB
- 可能触发额外检查

#### ⚠️ **可疑金额**
- 0.00001 BNB（测试粉尘攻击）
- 精确到很多小数位（可能是脚本生成）

---

## 🛠️ **解决方案**

### **方案 1：禁用浏览器扩展**

```bash
# 1. 禁用所有钱包扩展
# 2. 关闭安全软件
# 3. 使用隐身/无痕模式
# 4. 重新测试转账
```

---

### **方案 2：检查目标地址安全性**

我为您准备了地址检查脚本：

```bash
cd c:\Users\wangping\Desktop\traegaswaetll
node check-address.cjs
```

修改脚本第 7 行，填入您要转账的目标地址。

---

### **方案 3：小额测试**

如果不确定是否安全：

```bash
# 1. 先转 0.001 BNB 测试
# 2. 确认到账后再转大额
```

---

### **方案 4：更换网络/RPC**

某些 RPC 节点可能有风险检测：

```javascript
// 在 src/services/radrsService.ts 中
// 更换 RPC 节点
http('https://bsc-dataseed.binance.org/'), // 官方节点
http('https://rpc.ankr.com/bsc'),          // Ankr
```

---

## 📋 **需要您提供的信息**

为了精准诊断，请提供：

1. **目标地址**（您要转账给谁）：
   ```
   0x...（完整地址）
   ```

2. **转账金额**：
   ```
   0.xxx BNB
   ```

3. **浏览器和扩展**：
   ```
   - 浏览器：Chrome / Edge / Brave / 其他
   - 已安装的钱包扩展：MetaMask / 其他
   ```

4. **警告出现时机**：
   ```
   - [ ] 输入地址后立即出现
   - [ ] 点击"发送"按钮后出现
   - [ ] 签名交易时出现
   ```

5. **控制台截图**：
   ```
   按 F12 → Console 标签 → 截图
   ```

---

## ✅ **如果确认是误报**

如果您确认：
1. 目标地址是安全的（您的朋友/交易所地址）
2. 金额是正确的
3. 没有安装第三方钱包扩展

那么可能是：
- ❌ 某个残留的测试代码
- ❌ 浏览器缓存问题
- ❌ 本地修改未提交

**清除缓存方法：**
```bash
# 1. 浏览器 F12
# 2. Application → Storage → Clear site data
# 3. 刷新页面
```

---

## 🚨 **如果确实是高风险地址**

**不要转账！** 如果警告是真实的：

| 风险类型 | 说明 | 后果 |
|---------|------|------|
| **诈骗地址** | 钓鱼网站、假空投 | 资金丢失 |
| **黑名单地址** | 被盗资金、制裁地址 | 资金被冻结/无法交易 |
| **合约漏洞** | 恶意合约 | 资金被盗 |

---

## 📝 **下一步**

**请立即提供：**
1. 转账目标地址
2. 控制台截图（F12）
3. 已安装的浏览器扩展列表

我将立即帮您诊断！🔍
