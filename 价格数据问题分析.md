# ğŸ” ä»·æ ¼æ•°æ®ä¸å‡†ç¡®é—®é¢˜åˆ†æ

## ğŸ“Š é—®é¢˜æ¦‚è¿°

**ä½ çœ‹åˆ°çš„ä»·æ ¼**:
- BNB: $926.46 âŒ
- USDT: $1.00 âœ…
- RADRS: $0.14505 âš ï¸

**å®é™…ä»·æ ¼ (2026å¹´1æœˆ)**:
- BNB: åº”è¯¥åœ¨ $600-700 å·¦å³
- USDT: $1.00 âœ…
- RADRS: éœ€è¦ä» DEX å®æ—¶è·å–

---

## ğŸ”´ æ ¹æœ¬åŸå› 

### åŸå›  1: ç¡¬ç¼–ç çš„åˆå§‹ä»·æ ¼

**ä½ç½®**: `src/store/useAppStore.ts` ç¬¬115-149è¡Œ

```typescript
const MOCK_NETWORKS: Network[] = [
  {
    id: 'bsc',
    name: 'BSC',
    chainId: 56,
    assets: [
      // âŒ è¿™é‡Œç¡¬ç¼–ç äº† 926.46ï¼Œè¿™æ˜¯æ—§çš„/é”™è¯¯çš„ä»·æ ¼
      { symbol: 'BNB', name: 'Binance Coin', balance: '0.0000', price: 926.46 },
      { symbol: 'USDT', name: 'Tether USD', balance: '0.00', price: 1.0 },
      { symbol: 'RADRS', name: 'Radar Token', balance: '200.00', price: 0.14505 },
    ]
  },
  // ... å…¶ä»–ç½‘ç»œ ...
]
```

### åŸå›  2: Binance API è°ƒç”¨å¤±è´¥

**ä½ç½®**: `src/services/priceService.ts` ç¬¬6è¡Œ

```typescript
const bnbRes = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=BNBUSDT')
```

**é”™è¯¯**: `net::ERR_FAILED 451 (Unavailable For Legal Reasons)`

**åŸå› **: 
- HTTP 451 = "å› æ³•å¾‹åŸå› ä¸å¯ç”¨"
- Binance API åœ¨ä½ æ‰€åœ¨åœ°åŒºè¢«é™åˆ¶è®¿é—®
- æˆ–è€… CORS è·¨åŸŸç­–ç•¥é˜»æ­¢

**ç»“æœ**: 
- `priceService.fetchPrices()` è¿”å› `{}` (ç©ºå¯¹è±¡)
- `updateRealtimePrices({})` æ— æ³•æ›´æ–°ä»·æ ¼
- ä»·æ ¼ä¿æŒåˆå§‹çš„ç¡¬ç¼–ç å€¼ 926.46

---

## ğŸ“ ä»·æ ¼æ›´æ–°æµç¨‹åˆ†æ

### å½“å‰æµç¨‹ (å¤±è´¥)

```
1. App.tsx å¯åŠ¨
   â†“
2. è°ƒç”¨ priceService.fetchPrices()
   â†“
3. å°è¯•è®¿é—® Binance API
   â†“
4. âŒ è¿”å› HTTP 451 é”™è¯¯
   â†“
5. catch å—æ•è·é”™è¯¯ï¼Œè¿”å› {}
   â†“
6. updateRealtimePrices({})
   â†“
7. å› ä¸ºç©ºå¯¹è±¡ï¼Œprice ä¸ä¼šè¢«æ›´æ–°
   â†“
8. âŒ ä»·æ ¼ä»ç„¶æ˜¯ MOCK_NETWORKS ä¸­çš„ 926.46
```

### ä»£ç è¯æ®

**App.tsx** (ä»·æ ¼æ›´æ–°é€»è¾‘):
```typescript
useEffect(() => {
    const fetchAndSetPrices = async () => {
        const prices = await priceService.fetchPrices()
        if (Object.keys(prices).length > 0) {
            updateRealtimePrices(prices)
        }
    }
    fetchAndSetPrices()
    const interval = setInterval(fetchAndSetPrices, 60000)
    return () => clearInterval(interval)
}, [])
```

**priceService.ts** (é”™è¯¯å¤„ç†):
```typescript
try {
  const bnbRes = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=BNBUSDT')
  const bnbData = await bnbRes.json()
  return {
    'BNB': parseFloat(bnbData.price),
    // ...
  }
} catch (error) {
  console.error('Failed to fetch prices:', error)
  return {}  // âŒ è¿”å›ç©ºå¯¹è±¡ï¼Œå¯¼è‡´ä»·æ ¼ä¸æ›´æ–°
}
```

**useAppStore.ts** (æ›´æ–°ä»·æ ¼):
```typescript
updateRealtimePrices: (prices) => set((state) => {
    const updatedNetworks = state.networks.map(n => ({
        ...n,
        assets: n.assets.map(a => {
            if (prices[a.symbol]) {  // âŒ prices æ˜¯ç©ºå¯¹è±¡ï¼Œè¿™ä¸ªæ¡ä»¶æ°¸è¿œä¸æ»¡è¶³
                return { ...a, price: prices[a.symbol] }
            }
            return a  // âŒ è¿”å›åŸå§‹ä»·æ ¼ 926.46
        })
    }))
    return { networks: updatedNetworks }
}),
```

---

## ğŸ¯ è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1: ä¿®å¤ç¡¬ç¼–ç ä»·æ ¼ (ä¸´æ—¶)

**ä½ç½®**: `src/store/useAppStore.ts` ç¬¬122è¡Œ

**å½“å‰**:
```typescript
{ symbol: 'BNB', name: 'Binance Coin', balance: '0.0000', price: 926.46 }
```

**ä¿®æ”¹ä¸º** (æ›´æ¥è¿‘çœŸå®ä»·æ ¼):
```typescript
{ symbol: 'BNB', name: 'Binance Coin', balance: '0.0000', price: 650 }
```

---

### æ–¹æ¡ˆ 2: ä½¿ç”¨å¤‡ç”¨ä»·æ ¼æº (æ¨è)

**ä¿®æ”¹**: `src/services/priceService.ts`

**é€‰é¡¹ A - CoinGecko API** (æ— åœ°åŒºé™åˆ¶):
```typescript
async fetchPrices(): Promise<Record<string, number>> {
  try {
    // CoinGecko API (å…è´¹ï¼Œæ— éœ€ API Key)
    const response = await fetch(
      'https://api.coingecko.com/api/v3/simple/price?ids=binancecoin,ethereum,matic-network&vs_currencies=usd'
    )
    const data = await response.json()
    
    // RADRS ä»·æ ¼ä»ç„¶ä» GeckoTerminal è·å–
    let radrsPrice = 0.14505
    try {
      const radrsRes = await fetch(
        'https://api.geckoterminal.com/api/v2/networks/bsc/tokens/0xe2188a2e0a41a50f09359e5fe714d5e643036f2a'
      )
      const radrsData = await radrsRes.json()
      if (radrsData.data?.attributes?.price_usd) {
        radrsPrice = parseFloat(radrsData.data.attributes.price_usd)
      }
    } catch (e) {
      console.error('Failed to fetch RADRS price:', e)
    }
    
    return {
      'BNB': data.binancecoin?.usd || 650,
      'ETH': data.ethereum?.usd || 3000,
      'MATIC': data['matic-network']?.usd || 0.8,
      'USDT': 1.00,
      'RADRS': radrsPrice
    }
  } catch (error) {
    console.error('Failed to fetch prices:', error)
    // âœ… è¿”å›åˆç†çš„é™çº§ä»·æ ¼ï¼Œè€Œä¸æ˜¯ç©ºå¯¹è±¡
    return {
      'BNB': 650,
      'ETH': 3000,
      'MATIC': 0.8,
      'USDT': 1.00,
      'RADRS': 0.14505
    }
  }
}
```

**é€‰é¡¹ B - ä½¿ç”¨ä»£ç†æœåŠ¡å™¨**:
```typescript
// åˆ›å»ºåç«¯ä»£ç† API
// backend/api/prices.ts
export async function GET() {
  const response = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=BNBUSDT')
  const data = await response.json()
  return Response.json(data)
}

// å‰ç«¯è°ƒç”¨
const bnbRes = await fetch('/api/prices')
```

---

### æ–¹æ¡ˆ 3: æ·»åŠ é™çº§ä»·æ ¼ (æœ€ç®€å•)

**ä¿®æ”¹**: `src/services/priceService.ts` ç¬¬45-48è¡Œ

**å½“å‰**:
```typescript
} catch (error) {
  console.error('Failed to fetch prices:', error)
  return {}  // âŒ è¿”å›ç©ºå¯¹è±¡
}
```

**ä¿®æ”¹ä¸º**:
```typescript
} catch (error) {
  console.error('Failed to fetch prices:', error)
  // âœ… è¿”å›åˆç†çš„é™çº§ä»·æ ¼
  return {
    'BNB': 650,      // æ›´æ–°ä¸ºåˆç†çš„ä»·æ ¼
    'USDT': 1.00,
    'ETH': 3000,
    'MATIC': 0.8,
    'RADRS': 0.14505
  }
}
```

---

## ğŸ”§ å…³äºæ¸…é™¤ç¼“å­˜

### æ¸…é™¤ç¼“å­˜å·¥å…·ä½ç½®

æˆ‘å·²ç»åˆ›å»ºäº† `clear-cache.html` æ–‡ä»¶åœ¨é¡¹ç›®æ ¹ç›®å½•ã€‚

**æ‰“å¼€æ–¹å¼**:

#### æ–¹æ³• 1: åŒå‡»æ‰“å¼€
1. åœ¨æ–‡ä»¶èµ„æºç®¡ç†å™¨ä¸­
2. æ‰¾åˆ° `C:\Users\wangping\Desktop\traegaswaetll\clear-cache.html`
3. åŒå‡»æ‰“å¼€

#### æ–¹æ³• 2: æ‹–æ‹½åˆ°æµè§ˆå™¨
1. æ‹–æ‹½ `clear-cache.html` æ–‡ä»¶åˆ°æµè§ˆå™¨çª—å£
2. æˆ–å³é”® â†’ "æ‰“å¼€æ–¹å¼" â†’ é€‰æ‹©æµè§ˆå™¨

#### æ–¹æ³• 3: æ‰‹åŠ¨åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€
1. æ‰“å¼€æµè§ˆå™¨
2. æŒ‰ `Ctrl + O`
3. é€‰æ‹© `clear-cache.html` æ–‡ä»¶

---

## ğŸ“Š ä¼˜å…ˆçº§å»ºè®®

| æ–¹æ¡ˆ | éš¾åº¦ | æ•ˆæœ | æ¨èæŒ‡æ•° |
|------|------|------|----------|
| æ–¹æ¡ˆ 3: æ·»åŠ é™çº§ä»·æ ¼ | â­ ç®€å• | ğŸŸ¡ ä¸´æ—¶è§£å†³ | â­â­â­â­â­ |
| æ–¹æ¡ˆ 1: ä¿®å¤ç¡¬ç¼–ç  | â­ ç®€å• | ğŸŸ¡ ä¸´æ—¶è§£å†³ | â­â­â­ |
| æ–¹æ¡ˆ 2A: CoinGecko API | â­â­ ä¸­ç­‰ | ğŸŸ¢ å®Œç¾è§£å†³ | â­â­â­â­â­ |
| æ–¹æ¡ˆ 2B: ä»£ç†æœåŠ¡å™¨ | â­â­â­ å›°éš¾ | ğŸŸ¢ å®Œç¾è§£å†³ | â­â­â­ |

---

## ğŸ’¡ å»ºè®®çš„ä¿®å¤é¡ºåº

1. **ç«‹å³**: æ–¹æ¡ˆ 3 (æ·»åŠ é™çº§ä»·æ ¼) - 5åˆ†é’Ÿ
2. **çŸ­æœŸ**: æ–¹æ¡ˆ 1 (ä¿®å¤ç¡¬ç¼–ç ) - 2åˆ†é’Ÿ
3. **é•¿æœŸ**: æ–¹æ¡ˆ 2A (CoinGecko API) - 15åˆ†é’Ÿ

---

## ğŸ¯ æ€»ç»“

**ä¸ºä»€ä¹ˆä»·æ ¼æ˜¯ $926.46**:
1. âœ… è¿™æ˜¯ `MOCK_NETWORKS` ä¸­ç¡¬ç¼–ç çš„åˆå§‹å€¼
2. âŒ Binance API è¢«åœ°åŒºé™åˆ¶ (HTTP 451)
3. âŒ ä»·æ ¼æœåŠ¡è¿”å›ç©ºå¯¹è±¡ï¼Œæ— æ³•æ›´æ–°
4. âŒ ä»·æ ¼ä¿æŒåˆå§‹å€¼ä¸å˜

**è§£å†³æ–¹æ¡ˆ**:
- **æœ€å¿«**: ä¿®æ”¹é™çº§ä»·æ ¼ (5åˆ†é’Ÿ)
- **æœ€å¥½**: ä½¿ç”¨ CoinGecko API (15åˆ†é’Ÿ)

**æ¸…é™¤ç¼“å­˜**:
- æ‰“å¼€ `clear-cache.html` æ–‡ä»¶
- æˆ–è€…åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œ: `localStorage.removeItem('app-store')`
